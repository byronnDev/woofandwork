---
import Layout from '../../layouts/Layout.astro';
import Post from '../../layouts/Post.astro';

const { slug } = Astro.params;
const posts = await Astro.glob<{
    frontmatter: {
        title: string;
        description: string;
        author: string;
        image?: {
            url: string;
            alt: string;
        };
        tags?: string[];
    };
    default: any;
}>('../../content/posts/*.md');

const post = posts.find(p => p.file.split('/').pop()?.replace('.md', '') === slug);

if (!post) {
    throw new Error(`Post no encontrado: ${slug}`);
}

const Content = post.default;

const pageTitle = `${post.frontmatter.title} | Blog`;
const metaTags = [
    { name: "description", content: post.frontmatter.description },
    { property: "og:title", content: post.frontmatter.title },
    { property: "og:description", content: post.frontmatter.description },
    { property: "og:type", content: "article" },
    post.frontmatter.image && {
        property: "og:image",
        content: post.frontmatter.image.url
    }
].filter(Boolean);
---

<Layout title={pageTitle} meta={metaTags}>
    <Post frontmatter={post.frontmatter}>
        <Content />
    </Post>
</Layout>